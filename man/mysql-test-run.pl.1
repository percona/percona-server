'\" t
.\"     Title: \fBmysql-test-run.pl\fR
.\"    Author: [FIXME: author] [see http://docbook.sf.net/el/author]
.\" Generator: DocBook XSL Stylesheets v1.79.1 <http://docbook.sf.net/>
.\"      Date: 03/14/2017
.\"    Manual: MySQL Database System
.\"    Source: MySQL
.\"  Language: English
.\"
.TH "\FBMYSQL\-TEST\-RUN\" "1" "03/14/2017" "MySQL" "MySQL Database System"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
mysql-test-run.pl \- run MySQL test suite
.SH "SYNOPSIS"
.HP \w'\fBmysql\-test\-run\&.pl\ [\fR\fB\fIoptions\fR\fR\fB]\fR\ 'u
\fBmysql\-test\-run\&.pl [\fR\fB\fIoptions\fR\fR\fB]\fR
.SH "DESCRIPTION"
.PP
The
\fBmysql\-test\-run\&.pl\fR
Perl script is the main application used to run the MySQL test suite\&. It invokes
\fBmysqltest\fR
to run individual test cases\&.
.PP
Invoke
\fBmysql\-test\-run\&.pl\fR
in the
mysql\-test
directory like this:
.sp
.if n \{\
.RS 4
.\}
.nf
shell> \fBmysql\-test\-run\&.pl [\fR\fB\fIoptions\fR\fR\fB] [\fR\fB\fItest_name\fR\fR\fB] \&.\&.\&.\fR
.fi
.if n \{\
.RE
.\}
.PP
Each
\fItest_name\fR
argument names a test case\&. The test case file that corresponds to the test name is
t/\fItest_name\fR\&.test\&.
.PP
For each
\fItest_name\fR
argument,
\fBmysql\-test\-run\&.pl\fR
runs the named test case\&. With no
\fItest_name\fR
arguments,
\fBmysql\-test\-run\&.pl\fR
runs all
\&.test
files in the
t
subdirectory\&.
.PP
If no suffix is given for the test name, a suffix of
\&.test
is assumed\&. Any leading path name is ignored\&. These commands are equivalent:
.sp
.if n \{\
.RS 4
.\}
.nf
shell> \fBmysql\-test\-run\&.pl mytest\fR
shell> \fBmysql\-test\-run\&.pl mytest\&.test\fR
shell> \fBmysql\-test\-run\&.pl t/mytest\&.test\fR
.fi
.if n \{\
.RE
.\}
.PP
A suite name can be given as part of the test name\&. That is, the syntax for naming a test is:
.sp
.if n \{\
.RS 4
.\}
.nf
[\fIsuite_name\fR\&.]\fItest_name\fR[\&.\fIsuffix\fR]
.fi
.if n \{\
.RE
.\}
.PP
If a suite name is given,
\fBmysql\-test\-run\&.pl\fR
looks in that suite for the test\&. The test file corresponding to a test named
\fIsuite_name\&.test_name\fR
is found in
suite/\fIsuite_name\fR/t/\fItest_name\fR\&.test\&. There is also an implicit suite name
main
for the tests in the top
t
directory\&. With no suite name,
\fBmysql\-test\-run\&.pl\fR
looks in the default list of suites for a match and runs the test in any suites where it finds the test\&. Suppose that the default suite list is
main,
binlog,
rpl, and that a test
mytest\&.test
exists in the
main
and
rpl
suites\&. With an argument of
mytest
or
mytest\&.test,
\fBmysql\-test\-run\&.pl\fR
will run
mytest\&.test
from the
main
and
rpl
suites\&.
.PP
To run a family of test cases for which the names share a common prefix, use the
\fB\-\-do\-test=\fR\fB\fIprefix\fR\fR
option\&. For example,
\fB\-\-do\-test=rpl\fR
runs the replication tests (test cases that have names beginning with
rpl)\&.
\fB\-\-skip\-test\fR
has the opposite effect of skipping test cases for which the names share a common prefix\&.
.PP
The argument for the
\fB\-\-do\-test\fR
and
\fB\-\-skip\-test\fR
options also allows more flexible specification of which tests to perform or skip\&. If the argument contains a pattern metacharacter other than a lone period, it is interpreted as a Perl regular expression and applies to test names that match the pattern\&. If the argument contains a lone period or does not contain any pattern metacharacters, it is interpreted the same way as previously and matches test names that begin with the argument value\&. For example,
\fB\-\-do\-test=testa\fR
matches tests that begin with
testa,
\fB\-\-do\-test=main\&.testa\fR
matches tests in the
main
test suite that begin with
testa, and
\fB\-\-do\-test=main\&.*testa\fR
matches test names that contain
main
followed by
testa
with anything in between\&. In the latter case, the pattern match is not anchored to the beginning of the test name, so it also matches names such as
xmainytesta\&.
.PP
As of MySQL 5\&.7, it is possible to put a list of test names in a file and have
\fBmysql\-test\-run\&.pl\fR
run those tests, using the option
\fB\-\-do\-test\-list=\fR\fB\fIfile\fR\fR\&. The tests should be listed one per line in the file, using the fully qualified name
\fIsuite\fR\&.\fItest\fR\&. A space may be used in place of the period\&. A line beginning with
#
indicates a comment and is ignored\&.
.PP
As of MySQL 8\&.0,
\fBmysql\-test\-run\&.pl\fR
supports a
\fB\-\-do\-suite\fR
option, which is similar to
\fB\-\-do\-test\fR
but permits specifying entire suites of tests to run\&.
.PP
To perform setup prior to running tests,
\fBmysql\-test\-run\&.pl\fR
needs to invoke
\fBmysqld\fR
with the
\fB\-\-bootstrap\fR
and
\fB\-\-skip\-grant\-tables\fR
options\&. If MySQL was built with the compiler flag
\fB\-DDISABLE_GRANT_OPTIONS\fR, then
\fB\-\-bootstrap\fR,
\fB\-\-skip\-grant\-tables\fR, and
\fB\-\-init\-file\fR
will be disabled\&. To handle this, set the
MYSQLD_BOOTSTRAP
environment variable to the full path name of a server that has all options enabled\&.
\fBmysql\-test\-run\&.pl\fR
will use that server to perform setup; it is not used to run the tests\&.
.PP
The
init_file
test will fail if
\fB\-\-init\-file\fR
is disabled\&. This is an expected failure in this case\&.
.PP
To run
\fBmysql\-test\-run\&.pl\fR
on Windows, you\*(Aqll need either Cygwin or ActiveState Perl to run it\&. You may also need to install the modules required by the script\&. To run the test script, change location into the
mysql\-test
directory, set the
MTR_VS_CONFIG
environment variable to the configuration you selected earlier (or use the
\fB\-\-vs\-config\fR
option), and invoke
\fBmysql\-test\-run\&.pl\fR\&. For example (using Cygwin and the
\fBbash\fR
shell):
.sp
.if n \{\
.RS 4
.\}
.nf
shell> \fBcd mysql\-test\fR
shell> \fBexport MTR_VS_CONFIG=debug\fR
shell> \fB\&./mysqltest\-run\&.pl \-\-force \-\-timer\fR
shell> \fB\&./mysqltest\-run\&.pl \-\-force \-\-timer \-\-ps\-protocol\fR
.fi
.if n \{\
.RE
.\}
.PP
\fBmysql\-test\-run\&.pl\fR
uses several environment variables\&. Some of them are listed in the following table\&. Some of these are set from the outside and used by
\fBmysql\-test\-run\&.pl\fR, others are set by
\fBmysql\-test\-run\&.pl\fR
instead, and may be referred to in tests\&.
.TS
allbox tab(:);
lB lB.
T{
Variable
T}:T{
Description
T}
.T&
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l
l l.
T{
MTR_BUILD_THREAD
T}:T{
If set, defines which port number range is used for the server
T}
T{
MTR_MEM
T}:T{
If set to anything, will run tests with files in "memory" using tmpfs or
                ramdisk\&. Not available on Windows\&. Same as
                \fB\-\-mem\fR option
T}
T{
MTR_MAX_PARALLEL
T}:T{
If set, defines maximum number of parallel threads if
                \fB\-\-parallel=auto\fR is given
T}
T{
MTR_\fINAME\fR_TIMEOUT
T}:T{
Setting of a timeout in minutes or seconds, corresponding to command
                line option
                \fB\-\-\fR\fB\fIname\fR\fR\fB\-timeout\fR\&.
                Avaliable timeout names are TESTCASE,
                SUITE (both in minutes) and
                START, SHUTDOWN,
                CTEST (all in seconds)\&.
                MTR_CTEST_TIMEOUT is for
                \fBctest\fR unit tests; it was added in
                MySQL 8\&.0\&.0\&.
T}
T{
MTR_PARALLEL
T}:T{
If set, defines number of parallel threads executing tests\&. Same as
                \fB\-\-parallel\fR option
T}
T{
MTR_PORT_BASE
T}:T{
If set, defines which port number range is used for the server
T}
T{
MYSQL_CONFIG_EDITOR
T}:T{
Path name to \fBmysql_config_editor\fR binary\&. Supported as
                of MySQL 5\&.6\&.6\&.
T}
T{
MYSQL_TEST
T}:T{
Path name to \fBmysqltest\fR binary
T}
T{
MYSQL_TEST_DIR
T}:T{
Full path to the mysql\-test directory where tests
                are being run from
T}
T{
MYSQL_TEST_LOGIN_FILE
T}:T{
Path name to login file used by \fBmysql_config_editor\fR\&.
                If not set, the default is
                $HOME/\&.mylogin\&.cnf, or
                %APPDATA%\eMySQL\e\&.mylogin\&.cnf on
                Windows\&. Supported as of MySQL 5\&.6\&.6\&.
T}
T{
MYSQL_TMP_DIR
T}:T{
Path to temp directory used for temporary files during tests
T}
T{
MYSQLD
T}:T{
Full path to server executable used in tests\&. Supported as of MySQL
                5\&.5\&.17\&.
T}
T{
MYSQLD_BOOTSTRAP
T}:T{
Full path name to \fBmysqld\fR that has all options enabled
T}
T{
MYSQLD_BOOTSTRAP_CMD
T}:T{
Full command line used for initial database setup for this test batch
T}
T{
MYSQLD_CMD
T}:T{
Command line for starting server as used in tests, with the minimum set
                of required arguments\&. Supported as of MySQL 5\&.5\&.17\&.
T}
T{
MYSQLTEST_VARDIR
T}:T{
Path name to the var directory that is used for
                logs, temporary files, and so forth
T}
T{
TSAN_OPTIONS
T}:T{
Path name to a file containing ThreadSanitizer suppressions\&. Supported
                as of MySQL 8\&.0\&.1\&.
T}
.TE
.sp 1
.PP
The variable
MTR_PORT_BASE
is a more logical replacement for the original variable
MTR_BUILD_THREAD\&. It gives the actual port number directly (will be rounded down to a multiple of 10)\&. If you use
MTR_BUILD_THREAD, the port number is found by multiplying this by 10 and adding 10000\&.
.PP
Tests sometimes rely on certain environment variables being defined\&. For example, certain tests assume that
MYSQL_TEST
is defined so that
\fBmysqltest\fR
can invoke itself with
exec $MYSQL_TEST\&.
.PP
Other tests may refer to the last three variables listed in the preceding table, to locate files to read or write\&. For example, tests that need to create files will typically put them in
$MYSQL_TMP_DIR/\fIfile_name\fR\&.
.PP
The variable
$MYSQLD_CMD
will include any server options added with the
\fB\-\-mysqld\fR
option to
\fBmysql\-test\-run\&.pl\fR, but will not include server options added specifically for the currently running test\&.
.PP
\fBmysql\-test\-run\&.pl\fR
supports the options in the following list\&. An argument of
\fB\-\-\fR
tells
\fBmysql\-test\-run\&.pl\fR
not to process any following arguments as options\&.
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-help\fR,
\fB\-h\fR
.sp
Display a help message and exit\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-big\-test\fR
.sp
Allow tests marked as "big" to run\&. Tests can be thus marked by including the line
\-\-source include/big_test\&.inc, and they will only be run if this option is given, or if the environment variable
BIG_TEST
is set to 1\&.
.sp
This is typically done for tests that take very long to run, or that use very much resources, so that they are not suitable for running as part of a normal test suite run\&.
.sp
If both
\fB\-\-big\-test\fR
and
\fB\-\-only\-big\-tests\fR
are given,
\fB\-\-only\-big\-tests\fR
is ignored\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-boot\-dbx\fR
.sp
Run the
\fBmysqld\fR
server used for bootstrapping the database through the
\fBdbx\fR
debugger\&. This option is available from MySQL 5\&.5\&.17\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-boot\-ddd\fR
.sp
Run the
\fBmysqld\fR
server used for bootstrapping the database through the
\fBddd\fR
debugger\&. This option is available from MySQL 5\&.5\&.17\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-boot\-gdb\fR
.sp
Run the
\fBmysqld\fR
server used for bootstrapping the database through the
\fBgdb\fR
debugger\&. This option is available from MySQL 5\&.5\&.17\&.
.sp
See also the
\fB\-\-manual\-boot\-gdb\fR
option\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-build\-thread=\fR\fB\fInumber\fR\fR
.sp
Specify a number to calculate port numbers from\&. The formula is 10 *
\fIbuild_thread\fR
+ 10000\&. Instead of a number, it can be set to
auto, which is also the default value, in which case
\fBmysql\-test\-run\&.pl\fR
will allocate a number unique to this host\&.
.sp
The value (number or
auto) can also be set with the
MTR_BUILD_THREAD
environment variable\&.
.sp
This option is kept for backward compatibility\&. The more logical
\fB\-\-port\-base\fR
is recommended instead\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-callgrind\fR
.sp
Instructs
\fBvalgrind\fR
to use
\fBcallgrind\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-charset\-for\-testdb=\fR\fB\fIcharset_name\fR\fR
.sp
Specify the default character set for the
test
database\&. The default value is
latin1\&.
.sp
This option was added in MySQL 8\&.0\&.1\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-check\-testcases\fR
.sp
Check test cases for side effects\&. This is done by checking the system state before and after each test case; if there is any difference, a warning to that effect is written, but the test case is not marked as failed because of it\&. This check is enabled by default\&. To disable it, use the
\fB\-\-nocheck\-testcases\fR
option\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-clean\-vardir\fR
.sp
Clean up the
var
directory with logs and test results etc\&. after the test run, but only if there were no test failures\&. This option only has effect if also running with option
\fB\-\-mem\fR\&. The intent is to alleviate the problem of using up memory for test results, in cases where many different test runs are being done on the same host\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-client\-bindir=\fR\fB\fIpath\fR\fR
.sp
The path to the directory where client binaries are located\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-client\-dbx\fR
.sp
Start
\fBmysqltest\fR
in the
\fBdbx\fR
debugger\&. Support for dbx is available from MySQL 5\&.5\&.12\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-client\-ddd\fR
.sp
Start
\fBmysqltest\fR
in the
\fBddd\fR
debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-client\-debugger=\fR\fB\fIdebugger\fR\fR
.sp
Start
\fBmysqltest\fR
in the named debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-client\-gdb\fR
.sp
Start
\fBmysqltest\fR
in the
\fBgdb\fR
debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-client\-libdir=\fR\fB\fIpath\fR\fR
.sp
The path to the directory where client libraries are located\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-combination=\fR\fB\fIvalue\fR\fR
.sp
Extra option to pass to
\fBmysqld\fR\&. The value should consist of a single
\fBmysqld\fR
option including dashes\&. This option is similar to
\fB\-\-mysqld\fR
but has a different effect\&.
\fBmysql\-test\-run\&.pl\fR
executes multiple test runs, using the options for each instance of
\fB\-\-combination\fR
in successive runs\&. If
\fB\-\-combination\fR
is given only once, it has no effect\&. For test runs specific to a given test suite, an alternative to the use of
\fB\-\-combination\fR
is to create a
combinations
file in the suite directory\&. The file should contain a section of options for each test run\&. See
Section\ \&4.9, \(lqPassing Options from mysql-test-run.pl to mysqld or mysqltest\(rq\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-comment=\fR\fB\fIstr\fR\fR
.sp
Write
\fIstr\fR
to the output within lines filled with
#, as a form of banner\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-compress\fR
.sp
Compress all information sent between the client and the server if both support compression\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-cursor\-protocol\fR
.sp
Pass the
\fB\-\-cursor\-protocol\fR
option to
\fBmysqltest\fR
(implies
\fB\-\-ps\-protocol\fR)\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-dbx\fR
.sp
Start
\fBmysqld\fR
in the
\fBdbx\fR
debugger\&. Support for dbx is available from MySQL 5\&.5\&.12\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-ddd\fR
.sp
Start
\fBmysqld\fR
in the
\fBddd\fR
debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-debug\fR
.sp
Dump trace output for all clients and servers\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-debugger=\fR\fB\fIdebugger\fR\fR
.sp
Start
\fBmysqld\fR
using the named debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-debug\-common\fR
.sp
This option works similar to
\-\-debug
but turns on debug only for the debug macro keywords
query, info, error, enter, exit
which are considered the most commonly used\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-debug\-server\fR
.sp
Runs
mysqld\&.debug
(if available) instead of
mysqld
as server\&. If it does find
mysqld\&.debug, it will search for plugin libraries in a subdirectory
debug
under the directory where it\*(Aqs normally located\&. This option does not turn on trace output and is independent of the
\fBdebug\fR
option\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-debug\-sync\-timeout=\fR\fB\fIseconds\fR\fR
.sp
Controls whether the Debug Sync facility for testing and debugging is enabled\&. The option value is a timeout in seconds\&. The default value is 300\&. A value of 0 disables Debug Sync\&. The value of this option also becomes the default timeout for individual synchronization points\&.
.sp
\fBmysql\-test\-run\&.pl\fR
passes
\fB\-\-loose\-debug\-sync\-timeout=\fR\fB\fIseconds\fR\fR
to
\fBmysqld\fR\&. The
\fB\-\-loose\fR
prefix is used so that
\fBmysqld\fR
does not fail if Debug Sync is not compiled in\&.
.sp
For information about using the Debug Sync facility for testing, see
Section\ \&4.15, \(lqThread Synchronization in Test Cases\(rq\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-default\-myisam\fR
.sp
Use
MyISAM
as the default storage engine for all except
InnoDB\-specific tests\&. This option is on by default in MySQL 5\&.5 and 5\&.6, but is off by default as of MySQL 5\&.7\&. See also
\fB\-\-nodefault\-myisam\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-defaults\-file=\fR\fB\fIfile_name\fR\fR
.sp
Use the named file as fixed config file template for all tests\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-defaults_extra_file=\fR\fB\fIfile_name\fR\fR
.sp
Add setting from the named file to all generated configs\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-discover\fR
.sp
Attempt to preload
discover, the Developer Studio Memory Error Discovery Tool when starting
\fBmysqld\fR\&. Reports from
discover
may be found in
log/mysqld\&.%p\&.txt
under the directory given by
\fB\-\-vardir\fR\&. This option was added in MySQL 8\&.0\&.1\&. It is supported only on SPARC\-M7 systems\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-do\-suite=\fR\fB\fIprefix or regex\fR\fR
.sp
Run all test cases from suites having a name that begins with the given
\fIprefix\fR
value or matches the regular expression\&. If the argument matches no existing suites,
\fBmysql\-test\-run\&.pl\fR
aborts\&.
.sp
The argument for the
\fB\-\-do\-suite\fR
option allows more flexible specification of which tests to perform\&. See the description of the
\fB\-\-do\-test\fR
option for details\&.
.sp
The
\fB\-\-do\-suite\fR
option was added in MySQL 8\&.0\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-do\-test=\fR\fB\fIprefix or regex\fR\fR
.sp
Run all test cases having a name that begins with the given
\fIprefix\fR
value or matches the regular expression\&. This option provides a convenient way to run a family of similarly named tests\&.
.sp
The argument for the
\fB\-\-do\-test\fR
option allows more flexible specification of which tests to perform\&. If the argument contains a pattern metacharacter other than a lone period, it is interpreted as a Perl regular expression and applies to test names that match the pattern\&. If the argument contains a lone period or does not contain any pattern metacharacters, it is interpreted the same way as previously and matches test names that begin with the argument value\&. For example,
\fB\-\-do\-test=testa\fR
matches tests that begin with
testa,
\fB\-\-do\-test=main\&.testa\fR
matches tests in the
main
test suite that begin with
testa, and
\fB\-\-do\-test=main\&.*testa\fR
matches test names that contain
main
followed by
testa
with anything in between\&. In the latter case, the pattern match is not anchored to the beginning of the test name, so it also matches names such as
xmainytestz\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-do\-testlist=\fR\fB\fIfile\fR\fR
.sp
Run all tests listed in the file
\fIfile\fR\&. In this file, tests should be listed one per line in the form
\fIsuite\fR\&.\fItest\fR
or alternatively, with a space instead of the period\&. A line beginning with
#
will be ignored and can be used for comments\&.
.sp
The
\fB\-\-do\-test\-list\fR
option is available from MySQL 5\&.7\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-embedded\-server\fR
.sp
Use a version of
\fBmysqltest\fR
built with the embedded server\&. This option was removed in MySQL 8\&.0\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-enable\-disabled\fR
.sp
Ignore any
disabled\&.def
file, and run also tests marked as disbaled\&. Success or failure of those tests will be reported the same way as other tests\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-experimental=\fR\fB\fIfile_name\fR\fR
.sp
Specify a file that contains a list of test cases that should be displayed with the
[ exp\-fail ]
code rather than
[ fail ]
if they fail\&.
.sp
For an example of a file that might be specified using this option, see
mysql\-test/collections/default\&.experimental\&.
.sp
It is also possible to supply more than one
\fB\-\-experimental\fR, test cases listed in all the files will be treated as experimental\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-explain\-protocol\fR,
.sp
Run
EXPLAIN EXTENDED
on all
SELECT,
INSERT,
REPLACE,
UPDATE, and
DELETE
statements\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-extern\fR
\fIoption\fR=\fIvalue\fR
.sp
Use an already running server\&. The option/value pair is what is needed by the
\fBmysql\fR
client to connect to the server\&. Each
\fB\-\-extern\fR
can only take one option/value pair as argument, so it you need more you need to repeat
\fB\-\-extern\fR
for each of them\&. Example:
.sp
.if n \{\
.RS 4
.\}
.nf
      \&./mysql\-test\-run\&.pl \-\-extern socket=var/tmp/mysqld\&.1\&.sock alias
.fi
.if n \{\
.RE
.\}
.sp
Note: If a test case has an
\&.opt
file that requires the server to be restarted with specific options, the file will not be used\&. The test case likely will fail as a result\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-fast\fR
.sp
Do not perform controlled shutdown when servers need to be restarted or at the end of the test run\&. This is equivalent to using
\-\-shutdown\-timeout=0\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-fail\-check\-testcases\fR
.sp
Enabling this option when a test is run, causes it to fail if MTR\*(Aqs internal check of the test case fails\&. If this option is disabled, only a warning is generated while the test passes\&. This option is enabled by default\&. For additional information, see the description of the
\fB\-\-check\-testcases\fR
option\&.
.sp
The
\fB\-\-fail\-check\-testcases\fR
option was added in MySQL 8\&.0\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-force\fR
.sp
Normally,
\fBmysql\-test\-run\&.pl\fR
exits if a test case fails\&.
\fB\-\-force\fR
causes execution to continue regardless of test case failure\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-force\-restart\fR
.sp
Always restart the server(s) between each tast case, whether it\*(Aqs needed or not\&. Will also restart between repeated runs of the same test case\&. This may be useful e\&.g\&. when looking for the source of a memory leak, as there will only have been one test run before the server exits\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-gcov\fR
.sp
Run tests with the
\fBgcov\fR
test coverage tool\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-gdb\fR
.sp
Start
\fBmysqld\fR
in the
\fBgdb\fR
debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-gprof\fR
.sp
Run tests with the
\fBgprof\fR
profiling tool\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-include\-ndbcluster\fR,
\fB\-\-include\-ndb\fR
.sp
Run also tests that need Cluster\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-json\-explain\-protocol\fR,
.sp
Run
EXPLAIN FORMAT=JSON
on all SELECT, INSERT, REPLACE, UPDATE and DELETE queries\&. The
json\-explain\-protocol
option is available from MySQL 5\&.6\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-manual\-boot\-gdb\fR
.sp
This option is similar to
\fB\-\-boot\-gdb\fR
but attaches the debugger to the server during the bootstrapping process, permitting the use of a remote debugger\&. This option is available from MySQL 5\&.7\&.14\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-manual\-dbx\fR
.sp
Use a server that has already been started by the user in the
\fBdbx\fR
debugger\&. Support for dbx is available from MySQL 5\&.5\&.12\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-manual\-ddd\fR
.sp
Use a server that has already been started by the user in the
\fBddd\fR
debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-manual\-debug\fR
.sp
Use a server that has already been started by the user in a debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-manual\-gdb\fR
.sp
Use a server that has already been started by the user in the
\fBgdb\fR
debugger\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-mark\-progress\fR
.sp
Marks progress with timing (in milliseconds) and line number in
var/log/\fItestname\fR\&.progress\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-max\-connections=\fR\fB\fInum\fR\fR
.sp
The maximum number of simultaneous server connections that may be used per test\&. If not set, the maximum is 128\&. Minimum allowed limit is 8, maximum is 5120\&. Corresponds to the same option for
\fBmysqltest\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-max\-save\-core=\fR\fB\fIN\fR\fR
.sp
Limit the number of core files saved, to avoid filling up disks in case of a frequently crashing server\&. Defaults to 5, set to 0 for no limit\&. May also be set with the environment variable
MTR_MAX_SAVE_CORE
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-max\-save\-datadir=\fR\fB\fIN\fR\fR
.sp
Limit the number of data directories saved after failed tests, to avoid filling up disks in case of frequent failures\&. Defaults to 20, set to 0 for no limit\&. May also be set with the environment variable
MTR_MAX_SAVE_DATADIR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-max\-test\-fail=\fR\fB\fIN\fR\fR
.sp
Stop execution after the specified number of tests have failed, to avoid using up resources (and time) in case of massive failures\&. retries are noe counted, nor are failures of tests marked experimental\&. Defaults to 10, set to 0 for no limit\&. May also be set with the environment variable
MTR_MAX_TEST_FAIL
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-mem\fR
.sp
This option is not supported on Windows\&.
.sp
Run the test suite in memory, using tmpfs or ramdisk\&. This can decrease test times significantly, in particular if you would otherwise be running over a remote file system\&.
\fBmysql\-test\-run\&.pl\fR
attempts to find a suitable location using a built\-in list of standard locations for tmpfs and puts the
var
directory there\&. This option also affects placement of temporary files, which are created in
var/tmp\&.
.sp
The default list includes
/dev/shm\&. You can also enable this option by setting the environment variable
MTR_MEM[=\fIdir_name\fR]\&. If
\fIdir_name\fR
is given, it is added to the beginning of the list of locations to search, so it takes precedence over any built\-in locations\&.
.sp
Once you have run tests with
\fB\-\-mem\fR
within a
mysql\-testdirectory, a soflink
var
will have been set up to the temporary directory, and this will be re\-used the next time, until the soflink is deleted\&. Thus, you do not have to repeat the
\fB\-\-mem\fR
option next time\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-mysqld=\fR\fB\fIvalue\fR\fR
.sp
Extra option to pass to
\fBmysqld\fR\&. Only one option may be specified in
\fIvalue\fR; to specify more than one, use additional
\fB\-\-mysqld\fR
options\&. See
Section\ \&4.9, \(lqPassing Options from mysql-test-run.pl to mysqld or mysqltest\(rq\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-mysqld\-env=\fR\fB\fIvariable\fR\fR\fB=\fR\fB\fIvalue\fR\fR
.sp
Sets (or changes) an environment variable before starting
\fBmysqld\fR\&. Varibles set in the environment from which you run
\fBmysql\-test\-run\&.pl\fR
will normally also be propagated to
\fBmysqld\fR, but there may be cases where you want a setting just for a single run, or you may not want the setting to affect other programs\&. You may use additional
\fB\-\-mysqld\-env\fR
options to set more than one variable\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-mysqltest=\fR\fB\fIoptions\fR\fR
.sp
Extra options to pass to
\fBmysqltest\fR\&.
.sp
This option was added in MySQL 8\&.0\&.0\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-ndb\-connectstring=\fR\fB\fIstr\fR\fR
.sp
Pass
\fB\-\-ndb\-connectstring=\fR\fB\fIstr\fR\fR
to the master MySQL server\&. This option also prevents
\fBmysql\-test\-run\&.pl\fR
from starting a cluster\&. It is assumed that there is already a cluster running to which the server can connect with the given connectstring\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-nocheck\-testcases\fR
.sp
Disable the check for test case side effects\&. For additional information, see the description of the
\fB\-\-check\-testcases\fR
option\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-nodefault\-myisam\fR
.sp
For MySQL 5\&.5 or 5\&.6, do not override the build\-in default engine to use MyISAM instead for non\-InnoDB tests\&. Since the existing collection of tests were originally adapted for MyISAM as default, many tests will fail when this option is used, because the test behaves differently or produces different output when the engine switches to InnoDB\&.
.sp
From MySQL 5\&.7, the default engine for tests has been changed to InnoDB and this option will have no effect\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-noreorder\fR
.sp
Do not reorder tests to reduce number of restarts, but run them in exactly the order given\&. If a whole suite is to be run, the tests are run in alphabetic order, though similiar combinations will be grouped together\&. If more than one suite is listed, the tests are run one suite at a time, in the order listed\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-no\-skip\fR
.sp
This option forces all tests to run, ignoring any
\fB\-\-skip\fR
commands used in the test\&. This ensures that all tests are run\&. An excluded list (excludenoskip\&.list) is maintained to track which tests should continue to be skipped\&. The
\fB\-\-no\-skip\fR
option continues to skip the tests that are named in the excluded list\&. The default value of
\fB\-\-no\-skip\fR
introduced variable is OFF, which implies users are not forced to run all tests unless the
\fB\-\-no\-skip\fR
is explicitly used\&.
.sp
.if n \{\
.RS 4
.\}
.nf
shell> \fBmysql\-test\-run\&.pl\fR
          \fB\-\-suite=innodb\fR
          \fB\-\-no\-skip\fR
.fi
.if n \{\
.RE
.\}
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-notimer\fR
.sp
Cause
\fBmysqltest\fR
not to generate a timing file\&. The effect of this is that the report from each test case does not include the timing in milliseconds as it normally does\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-nounit\-tests\fR
.sp
Do not run unit tests, overriding default behavior or setting of the
MTR_UNIT_TESTS
variable\&.
.sp
Running of unit tests was enabled from MySQL 5\&.5\&.11\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-nowarnings\fR
.sp
Do not look for and report errors and warning in the server logs\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-only\-big\-tests\fR
.sp
This option causes only big tests to run\&. Normal (non\-big) tests are skipped\&. If both
\fB\-\-big\-test\fR
and
\fB\-\-only\-big\-tests\fR
are given,
\fB\-\-only\-big\-tests\fR
is ignored\&.
.sp
\fB\-\-only\-big\-tests\fR
was added in MySQL 8\&.0\&.1\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-parallel={\fR\fB\fIN\fR\fR\fB|auto}\fR
.sp
Run tests using
\fIN\fR
parallel threads\&. By default, 1 thread is used\&. Use
\fB\-\-parallel=auto\fR
to set
\fIN\fR
automatically\&.
.sp
Setting the
MTR_PARALLEL
environment variable to
\fIN\fR
has the same effect as specifying
\fB\-\-parallel=\fR\fB\fIN\fR\fR\&.
.sp
The
MTR_MAX_PARALLEL
environment variable, if set, specifies the maximum number of parallel workers that can be spawned when the
\fB\-\-parallel=auto\fR
option is specified\&. If
\fB\-\-parallel=auto\fR
is not specified,
MTR_MAX_PARALLEL
variable has no effect\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-port\-base=\fR\fB\fIP\fR\fR
.sp
Specify base of port numbers to be used; a block of 10 will be allocated\&.
\fIP\fR
should be divisible by 10; if it is not, it will be rounded down\&. If running with more than one parallel test thread, thread 2 will use the next block of 10 and so on\&.
.sp
If the port number is given as
auto, which is also the default,
\fBmysql\-test\-run\&.pl\fRwill allocate a number unique to this host\&. The value may also be given with the environment variable
MTR_PORT_BASE\&.
.sp
\fB\-\-port\-base\fR
was added in MySQL 5\&.1\&.45 as a more logical alternative to
\fB\-\-build\-thread\fR\&. If both are used,
\fB\-\-port\-base\fR
takes precedence\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-print\-testcases\fR
.sp
Do not run any tests, but print details about all tests, in the order they would have been run\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-ps\-protocol\fR
.sp
Pass the
\fB\-\-ps\-protocol\fR
option to
\fBmysqltest\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-record\fR
.sp
Pass the
\fB\-\-record\fR
option to
\fBmysqltest\fR\&. This option requires a specific test case to be named on the command line\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-reorder\fR
.sp
Reorder tests to minimize the number of server restarts needed\&. This is the default behavior\&. There is no guarantee that a particular set of tests will always end up in the same order\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-repeat=\fR\fB\fIN\fR\fR
.sp
Run each test
\fIN\fR
number of times\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-report\-features\fR
.sp
Display the output of
SHOW ENGINES
and
SHOW VARIABLES\&. This can be used to verify that binaries are built with all required features\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-report\-times\fR
.sp
At the end of the test run, write a summary of how much time was spent in various phases of execution\&. If you run with
\fB\-\-parallel\fR, the total will exceed the wall clock time passed, since it will be summed over all threads\&.
.sp
The times reported should only be treated as approximations, and the exact points where the time is taken may also change between releases\&. If the test run is aborted, including if a test fails and
\fB\-\-force\fR
is not in use, the time report will not be produced\&.
.sp
The
\fB\-\-report\-times\fR
is available from MySQL 5\&.5\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-retry=\fR\fB\fIN\fR\fR
.sp
If a test fails, it is retried up to a maximum of
\fIN\fR
runs, but will terminate after 2 failures\&. Default is 3, set to 1 or 0 for no retries\&. This option has no effect unless
\fB\-\-force\fR
is also used; without it, test execution will terminate after the first failure\&.
.sp
The
\fB\-\-retry\fR
and
\fB\-\-retry\-failure\fR
options do not affect how many times a test repeated with
\fB\-\-repeat\fR
may fail in total, as each repetition is considered a new test case, which may in turn be retried if it fails\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-retry\-failure=\fR\fB\fIN\fR\fR
.sp
Allow a failed and retried test to fail more than the default 2 times before giving it up\&. Setting it to 0 or 1 effectively turns off retries
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-sanitize\fR
.sp
Scan the server log files for warnings from various sanitizers\&. Use of this option assumes that MySQL was configured with
\fB\-DWITH_ASAN\fR
or
\fB\-DWITH_UBSAN\fR\&.
.sp
This option was added in MySQL 8\&.0\&.0\&. As of MySQL 8\&.0\&.1, the
TSAN_OPTIONS
environment variable can be set to specify the path name of a file containing ThreadSanitizer suppressions\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-shutdown\-timeout=\fR\fB\fIseconds\fR\fR
.sp
Max number of seconds to wait for servers to do controlled shutdown before killing them\&. Default is 10\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-combinations\fR
.sp
Do not apply combinations; ignore combinations file or option\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-ndbcluster\fR,
\fB\-\-skip\-ndb\fR
.sp
Do not start NDB Cluster; skip Cluster test cases\&. This option only has effect if you do have NDB, if not it will have no effect as it cannot run those tests anyway\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-ndbcluster\-slave\fR,
\fB\-\-skip\-ndb\-slave\fR
.sp
Do not start an NDB Cluster slave\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-rpl\fR
.sp
Skip replication test cases\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-ssl\fR
.sp
Do not start
\fBmysqld\fR
with support for SSL connections\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-test=\fR\fB\fIregex\fR\fR
.sp
Specify a regular expression to be applied to test case names\&. Cases with names that match the expression are skipped\&. tests to skip\&.
.sp
The argument for the
\fB\-\-skip\-test\fR
option allows more flexible specification of which tests to skip\&. If the argument contains a pattern metacharacter other than a lone period, it is interpreted as a Perl regular expression and applies to test names that match the pattern\&. See the description of the
\fB\-\-do\-test\fR
option for details\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-test\-list=\fR\fB\fIfile\fR\fR
.sp
Specify a file listing tests that should be skipped (disabled)\&.
.sp
The file has the same format as the
disabled\&.def
file listing disabled tests\&. With this option, disabling can be done on a case by case basis\&. The
\fB\-\-skip\-test\-list\fR
option is supported from MySQL 5\&.5\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-skip\-*\fR
.sp
\fB\-\-skip\-*\fR
options not otherwise recognized by
\fBmysql\-test\-run\&.pl\fR
are passed to the master server\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-sleep=\fR\fB\fIN\fR\fR
.sp
Pass
\fB\-\-sleep=\fR\fB\fIN\fR\fR
to
\fBmysqltest\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-sp\-protocol\fR
.sp
Pass the
\fB\-\-sp\-protocol\fR
option to
\fBmysqltest\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-ssl\fR
.sp
If
\fBmysql\-test\-run\&.pl\fR
is started with the
\fB\-\-ssl\fR
option, it sets up a secure connection for all test cases\&. In this case, if
\fBmysqld\fR
does not support SSL,
\fBmysql\-test\-run\&.pl\fR
exits with an error message:
Couldn\*(Aqt find support for SSL
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-start\fR
.sp
Initialize and start servers with the startup settings for the specified test case\&. You can use this option to start a server to which you can connect later\&. For example, after building a source distribution you can start a server and connect to it with the
\fBmysql\fR
client like this:
.sp
.if n \{\
.RS 4
.\}
.nf
shell> \fBcd mysql\-test\fR
shell> \fB\&./mysql\-test\-run\&.pl \-\-start alias &\fR
shell> \fB\&.\&./mysql \-S \&./var/tmp/master\&.sock \-h localhost \-u root\fR
.fi
.if n \{\
.RE
.\}
.sp
If no tests are named on the command line, the server(s) will be started with settings for the first test that would have been run without the
\fB\-\-start\fR
option\&.
.sp
\fBmysql\-test\-run\&.pl\fR
will stop once the server has been started, but will terminate if the server dies\&. If killed, it will also shut down the server\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-start\-and\-exit\fR
.sp
This is similar to
\fB\-\-start\fR, but
\fBmysql\-test\-run\&.pl\fR
terminates once the server has been started, leaving just the server process running\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-start\-dirty\fR
.sp
This is similar to
\fB\-\-start\fR, but will skip the database initialization phase and assume that database files are already available\&. Usually this means you must have run another test first\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-start\-from=\fR\fB\fItest_name\fR\fR
.sp
\fBmysql\-test\-run\&.pl\fR
sorts the list of names of the test cases to be run, and then begins with
\fItest_name\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-strace\-client\fR
.sp
Create
\fBstrace\fR
output for
\fBmysqltest\fR\&. Will produce default
\fBstrace\fR
output as
mysqltest\&.strace\&. Note that this will be overwritten for each new test case, so it\*(Aqs most useful for running only one test\&.
.sp
The
\fBstrace\-client\fR
option is functional from MySQL 5\&.5\&.20, and only supported on Linux\&. The option was available in earlier versions too, but was not working properly\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-strace\-server\fR
.sp
Create
\fBstrace\fR
output for the server\&. Will produce default
\fBstrace\fR
output as
mysqld\&.1\&.strace\&. Note that this will be overwritten each time the server is restarted, so it\*(Aqs most useful for running a single test, or if you want trace from the first test that fails\&.
.sp
The
\fBstrace\-server\fR
option is available from MySQL 5\&.5\&.20, on Linux only\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-stress=\fR\fB\fIstress options\fR\fR
.sp
Start a server, but instead of running a test, run
\fBmysql\-stress\-test\&.pl\fR
with the supplied arguments\&. Arguments needed to communicate with the server will be automatically provided, the rest should be given as arguments to this option\&. Command line options for
\fBmysql\-stress\-test\&.pl\fR
should be separeted by a comma\&.
.sp
The
\fBstress\fR
option was added in MySQL 5\&.5\&.17, it is not a direct replacement for the option of the same name that exists in version 1 of
\fBmysql\-test\-run\&.pl\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-suite=\fR\fB\fIsuite_name\fR\fR
.sp
Run the named test suite\&. The default name is
main
(the regular test suite located in the
mysql\-test
directory)\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-suite\-timeout=\fR\fB\fIminutes\fR\fR
.sp
Specify the maximum test suite runtime in minutes\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-summary\-report=\fR\fB\fIfile_name\fR\fR
.sp
Generate a plain text version of the test summary only and write it to the file named as the option argument\&. The file is suitable for sending by email\&. This option was added in MySQL 8\&.0\&.1\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-test\-progress\fR
.sp
Display the percentage of tests remaining\&. This option was added in MySQL 5\&.7\&.19\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-testcase\-timeout=\fR\fB\fIminutes\fR\fR
.sp
Specify the maximum test case runtime in minutes\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-timediff\fR
.sp
Adds to each test report for a test case, the total time in sconds and milliseconds passed since the preceding test ended\&. This option can only be used together with
\fB\-\-timestamp\fR, and has no effect without it\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-timer\fR
.sp
Cause
\fBmysqltest\fR
to generate a timing file\&. The default file is named
\&./var/log/timer\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-timestamp\fR
.sp
Prints a timestamp before the test case name in each test report line, showing when the test ended\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-tmpdir=\fR\fB\fIpath\fR\fR
.sp
The directory where temporary file are stored\&. The default location is
\&./var/tmp\&. The environment variable
MYSQL_TMP_DIR
will be set to the path for this directory, whether it has the default value or has been set explicitly\&. This may be referred to in tests\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-unit\-tests\fR
.sp
Force running of unit tests, overriding default behavior or setting of the
MTR_UNIT_TESTS
variable\&.
.sp
Running of unit tests was enabled from MySQL 5\&.5\&.11\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-unit\-tests\-report\fR
.sp
Extend the unit test run by also outputting the log from the test run, independently of whether it succeeded or not\&. This option implies
\fB\-\-unit\-tests\fR
so it is not necessary to specify both\&. The
\fB\-\-unit\-tests\-report\fR
option is available in MySQL 5\&.5 from version 5\&.5\&.44, in 5\&.6 from version 5\&.6\&.25 as well as in MySQL 5\&.7\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-user=\fR\fB\fIuser_name\fR\fR
.sp
The MySQL user name to use when connecting to the server\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-user\-args\fR
.sp
Drops all non\-essential command line arguments to the
\fBmysqld\fR
server, except those supplied with
\fB\-\-mysqld\fR
arguemnts, if any\&. Only works in combination with
\fB\-\-start\fR,
\fB\-\-start\-and\-exit\fR
or
\fB\-\-start\-dirty\fR, and only if no test name is given\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-valgrind\fR
.sp
Run
\fBmysqltest\fR
and
\fBmysqld\fR
with
\fBvalgrind\fR\&. This and the following
\fB\-\-valgrind\fR
options require that the executables have been build with
\fBvalgrind\fR
support\&.
.sp
When the server is run with valgrind, an extra pass over the server log file(s) will be performed after all tests are run, and any report with problems that have been reported at server shutdown will be extracted and printed\&. The most common warnings are memory leaks\&. With each report will also be listed all tests that were run since previous server restart; one of these is likely to have caused the problem\&.
.sp
From MySQL 5\&.5\&.13, a final "pseudo" test named
valgrind_report
is added to the list of tests when the server is run in valgrind\&. This test is reported as failed if any such shutdown warnings were produced by valgrind\&. Pass or failure of this test is also added to the total test count reported\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-valgrind\-clients\fR
.sp
Run all clients started by
\&.test
files with
\fBvalgrind\fR\&. This option requires
\fBvalgrind\fR
3\&.9 or later\&.
.sp
\fB\-\-valgrind\-clients\fR
was added in MySQL 5\&.7\&.9\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-valgrind\-mysqld\fR
.sp
Run the
\fBmysqld\fR
server with
\fBvalgrind\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-valgrind\-mysqltest\fR
.sp
Run
\fBmysqltest\fR
with
\fBvalgrind\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-valgrind\-option=\fR\fB\fIstr\fR\fR
.sp
Extra options to pass to
\fBvalgrind\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-valgrind\-path=\fR\fB\fIpath\fR\fR
.sp
Specify the path name to the
\fBvalgrind\fR
executable\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-vardir=\fR\fB\fIpath\fR\fR
.sp
Specify the path where files generated during the test run are stored\&. The default location is
\&./var\&. The environment variable
MYSQLTEST_VARDIR
will be set to the path for this directory, whether it has the default value or has been set explicitly\&. This may be referred to in tests\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-verbose\fR
.sp
Give more verbose output regarding test execution\&. Use the option twice to get even more output\&. Note that the output generated within each test case is not affected\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-verbose\-restart\fR
.sp
Write when and why servers are restarted between test cases\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-view\-protocol\fR
.sp
Pass the
\fB\-\-view\-protocol\fR
option to
\fBmysqltest\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-vs\-config=\fR\fB\fIconfig_val\fR\fR
.sp
Specify the configuration used to build MySQL (for example,
\fB\-\-vs\-config=debug\fR
\fB\-\-vs\-config=release\fR)\&. This option is for Windows only\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-wait\-all\fR
.sp
If
\fB\-\-start\fR
or
\fB\-\-start\-dirty\fR
is used, wait for all servers to exit before termination\&. Otherise, it will terminate if one (of several) servers is restarted\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-warnings\fR
.sp
Search the server log for errors or warning after each test and report any suspicious ones; if any are found, the test will be marked as failed\&. This is the default behavior, it may be turned off with
\fB\-\-nowarnings\fR\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB\-\-with\-ndbcluster\-only\fR
.sp
Run only test cases that have
ndb
in their name\&.
.RE
.if n \{\
.sp
.\}
.RS 4
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBNote\fR
.ps -1
.br
.PP
The hostname resolves to 127\&.0\&.0\&.1 and not to the actual IP address\&.
.sp .5v
.RE
.SH "COPYRIGHT"
.br
.PP
Copyright \(co 2006, 2017, Oracle and/or its affiliates. All rights reserved.
.PP
This documentation is free software; you can redistribute it and/or modify it only under the terms of the GNU General Public License as published by the Free Software Foundation; version 2 of the License.
.PP
This documentation is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
.PP
You should have received a copy of the GNU General Public License along with the program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA or see http://www.gnu.org/licenses/.
.sp
.SH "SEE ALSO"
For more information, please refer to the MySQL Reference Manual,
which may already be installed locally and which is also available
online at http://dev.mysql.com/doc/.
.SH AUTHOR
Oracle Corporation (http://dev.mysql.com/).
