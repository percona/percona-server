--source include/have_component_audit_log.inc
--source ../inc/audit_tables_init.inc
--source ../inc/audit_comp_install.inc

SET @old_key_derivation_iterations_count_mean = @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=DEFAULT;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=1000;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=10000;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=999;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=0;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=1000000;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=1000001;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=-1;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

--error ER_WRONG_TYPE_FOR_VAR
SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean=10000.5;
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

--error ER_WRONG_TYPE_FOR_VAR
SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean='str';
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

--error ER_WRONG_TYPE_FOR_VAR
SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean='';
SELECT @@global.audit_log_filter.key_derivation_iterations_count_mean;

SET GLOBAL audit_log_filter.key_derivation_iterations_count_mean = @old_key_derivation_iterations_count_mean;

--source ../inc/audit_comp_uninstall.inc
--source ../inc/audit_tables_cleanup.inc
