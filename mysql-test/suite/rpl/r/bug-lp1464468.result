include/master-slave.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the 'START SLAVE Syntax' in the MySQL Manual for more information.
[connection master]
DROP TABLE IF EXISTS `t`;
Warnings:
Note	1051	Unknown table 'test.t'
CREATE TABLE `t` (
`f1` int(10) unsigned NOT NULL,
PRIMARY KEY (`f1`)
) ENGINE=InnoDB;
DROP TRIGGER IF EXISTS t_insert_trig;
Warnings:
Note	1360	Trigger does not exist
CREATE TRIGGER t_insert_trig AFTER INSERT ON t
FOR EACH ROW 
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN
ROLLBACK TO savepoint_1;
# If the bug is not fixed then debug build will crash here with assertion.
END;
SAVEPOINT savepoint_1;
INSERT INTO dummy VALUES (1);
END |
INSERT INTO `t` VALUES (2);
INSERT INTO `t` VALUES (3);
DROP TABLE `t`;
include/show_binlog_events.inc
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
master-bin.000001	#	Query	#	#	use `test`; DROP TABLE IF EXISTS `t` /* generated by server */
master-bin.000001	#	Query	#	#	use `test`; CREATE TABLE `t` (
`f1` int(10) unsigned NOT NULL,
PRIMARY KEY (`f1`)
) ENGINE=InnoDB
master-bin.000001	#	Query	#	#	use `test`; DROP TRIGGER IF EXISTS t_insert_trig
master-bin.000001	#	Query	#	#	use `test`; CREATE DEFINER=`root`@`localhost` TRIGGER t_insert_trig AFTER INSERT ON t
FOR EACH ROW 
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN
ROLLBACK TO savepoint_1;
# If the bug is not fixed then debug build will crash here with assertion.
END;
SAVEPOINT savepoint_1;
INSERT INTO dummy VALUES (1);
END
master-bin.000001	#	Query	#	#	BEGIN
master-bin.000001	#	Table_map	#	#	table_id: # (test.t)
master-bin.000001	#	Write_rows	#	#	table_id: #
master-bin.000001	#	Query	#	#	SAVEPOINT `savepoint_1`
master-bin.000001	#	Table_map	#	#	table_id: # (test.t)
master-bin.000001	#	Xid	#	#	COMMIT /* XID */
master-bin.000001	#	Write_rows	#	#	table_id: #
master-bin.000001	#	Query	#	#	SAVEPOINT `savepoint_1`
master-bin.000001	#	Table_map	#	#	table_id: # (test.t)
master-bin.000001	#	Xid	#	#	COMMIT /* XID */
master-bin.000001	#	Query	#	#	use `test`; DROP TABLE `t` /* generated by server */
include/rpl_end.inc
