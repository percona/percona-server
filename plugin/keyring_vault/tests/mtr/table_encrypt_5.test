call mtr.add_suppression("\\[ERROR\\] Plugin keyring_vault reported: 'Could not open file with credentials.'");
call mtr.add_suppression("\\[ERROR\\] Plugin keyring_vault reported: 'keyring_vault initialization failure.");

--copy_file $MYSQL_TEST_DIR/std_data/keyring_vault_confs/keyring_vault.conf $MYSQL_TMP_DIR/keyring_vault.conf
--copy_file $MYSQL_TEST_DIR/std_data/keyring_vault_confs/keyring_vault2.conf $MYSQL_TMP_DIR/keyring_vault2.conf
--let $keyring_plugin_name=keyring_vault
--let $keyring1_restart_param= restart: --early-plugin-load="keyring_vault=$KEYRING_VAULT_PLUGIN" --loose-keyring_vault_config=$MYSQL_TMP_DIR/keyring_vault.conf $KEYRING_VAULT_PLUGIN_OPT
--let $keyring2_restart_param= restart: --early-plugin-load="keyring_vault=$KEYRING_VAULT_PLUGIN" --loose-keyring_vault_config=$MYSQL_TMP_DIR/keyring_vault2.conf $KEYRING_VAULT_PLUGIN_OPT
--let $install_keyring_statement=INSTALL PLUGIN keyring_vault SONAME '$KEYRING_VAULT_PLUGIN'
--let $select_keyring_variable_statement=SELECT @@global.keyring_vault_config
--let $set_keyring_variable_to_keyring1=SET @@global.keyring_vault_config='$MYSQL_TMP_DIR/keyring_vault.conf'
--source include/table_encrypt_5.inc

--let $KEYRING_CONF_FILE=$MYSQL_TEST_DIR/std_data/keyring_vault_confs/keyring_vault.conf
--source ../plugin/keyring_vault/tests/mtr/vault_cleanup.inc
--let $KEYRING_CONF_FILE=$MYSQL_TEST_DIR/std_data/keyring_vault_confs/keyring_vault2.conf
--source ../plugin/keyring_vault/tests/mtr/vault_cleanup.inc
